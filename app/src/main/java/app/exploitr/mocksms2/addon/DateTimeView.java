package app.exploitr.mocksms2.addon;

import android.content.Context;
import android.graphics.Typeface;
import android.graphics.drawable.GradientDrawable;
import android.util.AttributeSet;
import android.util.TypedValue;
import android.view.Gravity;
import android.widget.LinearLayout;
import android.widget.TextView;

import androidx.annotation.ColorInt;
import androidx.core.content.ContextCompat;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Locale;

import app.exploitr.mocksms2.R;

public class DateTimeView extends LinearLayout {

    private TextView timeView;
    private TextView dateView;
    private SimpleDateFormat timeFormat;
    private SimpleDateFormat dateFormat;

    public DateTimeView(Context context) {
        super(context);
        init();
    }

    public DateTimeView(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();
    }

    private void init() {
        setOrientation(VERTICAL);
        timeFormat = new SimpleDateFormat("hh:mm:ss a", Locale.getDefault());
        dateFormat = new SimpleDateFormat("dd MMM yy", Locale.getDefault());

        timeView = new TextView(getContext());
        dateView = new TextView(getContext());

        timeView.setGravity(Gravity.CENTER_HORIZONTAL);
        timeView.setPadding(8, 8, 8, 8);
        timeView.setBackground(ContextCompat.getDrawable(getContext(), R.drawable.rounded_corner_background));

        dateView.setGravity(Gravity.CENTER_HORIZONTAL);
        dateView.setPadding(8, 8, 8, 8);

        addView(timeView);
        addView(dateView);

        updateTime();
    }

    public void updateTime() {
        Calendar calendar = Calendar.getInstance();
        timeView.setText(timeFormat.format(calendar.getTime()));
        dateView.setText(dateFormat.format(calendar.getTime()));
    }

    public void setTimeFontSize(int sizeInSp) {
        timeView.setTextSize(TypedValue.COMPLEX_UNIT_SP, sizeInSp);
    }

    public void setDateFontSize(int sizeInSp) {
        dateView.setTextSize(TypedValue.COMPLEX_UNIT_SP, sizeInSp);
    }

    public void setTypeface(Typeface typeface) {
        timeView.setTypeface(typeface);
        dateView.setTypeface(typeface);
    }

    public void setTimeBackgroundColor(@ColorInt int color) {
        GradientDrawable background = (GradientDrawable) timeView.getBackground();
        background.setColor(color);
    }
}
